# Model Training Configuration
# ============================

# Dataset Configuration
dataset:
  name: "microplastic_100"
  version: "4"
  total_images: 381
  classes: 6
  class_names:
    - film
    - fragment
    - pallet
    - pellet
    - fiber
    - foam
  
  # Data split ratios
  split:
    train: 0.70  # 267 images
    val: 0.20    # 76 images
    test: 0.10   # 38 images

# Model Architecture
model:
  base: "YOLOv8n"
  checkpoint: "COCOv8n"
  input_size: 640
  pretrained: true
  freeze_layers: 10  # Freeze first 10 layers for transfer learning

# Training Hyperparameters
training:
  epochs: 100
  batch_size: 16
  learning_rate: 0.001
  optimizer: "Adam"
  momentum: 0.937
  weight_decay: 0.0005
  warmup_epochs: 3
  warmup_momentum: 0.8
  warmup_bias_lr: 0.1
  
  # Loss weights
  box_loss: 7.5
  cls_loss: 0.5
  dfl_loss: 1.5
  
  # Augmentation
  augmentation:
    hsv_h: 0.015  # Image HSV-Hue augmentation
    hsv_s: 0.7    # Image HSV-Saturation augmentation
    hsv_v: 0.4    # Image HSV-Value augmentation
    degrees: 0.0  # Image rotation (+/- deg)
    translate: 0.1 # Image translation (+/- fraction)
    scale: 0.5    # Image scale (+/- gain)
    shear: 0.0    # Image shear (+/- deg)
    perspective: 0.0  # Image perspective (+/- fraction)
    flipud: 0.0   # Image flip up-down (probability)
    fliplr: 0.5   # Image flip left-right (probability)
    mosaic: 1.0   # Image mosaic (probability)
    mixup: 0.0    # Image mixup (probability)
    copy_paste: 0.0  # Segment copy-paste (probability)

# Validation Configuration
validation:
  iou_threshold: 0.6
  conf_threshold: 0.001
  max_det: 300
  
# Performance Metrics (Achieved)
metrics:
  map50: 0.958        # Mean Average Precision @ IoU 0.5
  map50_95: 0.847     # Mean Average Precision @ IoU 0.5:0.95
  precision: 0.978    # Precision
  recall: 0.965       # Recall
  
  # Per-class mAP@50
  class_metrics:
    film: 0.972
    fragment: 0.965
    pallet: 0.958
    pellet: 0.941
    fiber: 0.928
    foam: 0.884

# Hardware Configuration
hardware:
  device: "cuda"  # or "cpu"
  gpu: "NVIDIA RTX 3080"
  gpu_memory: "10GB"
  cpu_workers: 8
  mixed_precision: true  # FP16 training

# Training Environment
environment:
  framework: "Ultralytics YOLOv8"
  pytorch_version: "2.0.1"
  cuda_version: "11.8"
  python_version: "3.11.9"
  
# Callbacks and Monitoring
monitoring:
  tensorboard: true
  save_period: 10  # Save checkpoint every N epochs
  patience: 50     # Early stopping patience
  min_delta: 0.001 # Minimum change to qualify as improvement
  
# Export Configuration
export:
  formats:
    - onnx
    - torchscript
  optimization:
    simplify: true
    dynamic: false
    half: false

# Deployment Configuration
deployment:
  api_url: "https://detect.roboflow.com"
  model_id: "microplastic_100/4"
  confidence_threshold: 0.5
  overlap_threshold: 0.3
